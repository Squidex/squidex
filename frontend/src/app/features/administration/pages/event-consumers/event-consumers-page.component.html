<sqx-title message="i18n:eventConsumers.pageTitle"></sqx-title>

<sqx-layout layout="main" titleText="i18n:common.consumers" titleIcon="time" innerWidth="50">
    <ng-container menu>
        <button
            class="btn btn-text-secondary"
            (click)="reload()"
            type="button"
            title="i18n:eventConsumers.refreshTooltip"
            shortcut="CTRL + B">
            <i class="icon-reset"></i>
            {{ "common.refresh" | sqxTranslate }}
        </button>
    </ng-container>

    <ng-container>
        <sqx-list-view [isLoading]="eventConsumersState.isLoading | async" innerWidth="50rem" table="true">
            <ng-container header>
                <table class="table table-items table-fixed" #header>
                    <thead>
                        <tr>
                            <th class="cell-auto">
                                {{ "common.name" | sqxTranslate }}
                            </th>
                            <th class="cell-auto-right">
                                {{ "eventConsumers.count" | sqxTranslate }}
                            </th>
                            <th class="cell-auto-right">
                                {{ "eventConsumers.position" | sqxTranslate }}
                            </th>
                            <th class="cell-actions-lg">
                                {{ "common.actions" | sqxTranslate }}
                            </th>
                        </tr>
                    </thead>
                </table>
            </ng-container>

            <ng-container>
                <table class="table table-items table-fixed" [sqxSyncWidth]="header">
                    @for (eventConsumer of eventConsumersState.eventConsumers | async; track trackByEventConsumer($index, eventConsumer)) {
                        <tbody [sqxEventConsumer]="eventConsumer" (failure)="showError(eventConsumer)"></tbody>
                    }
                </table>
            </ng-container>
        </sqx-list-view>
    </ng-container>

    <ng-template sidebarMenu>
        <div class="panel-nav">
            <a
                class="panel-link"
                replaceUrl="true"
                routerLink="help"
                routerLinkActive="active"
                queryParamsHandling="preserve"
                title="i18n:common.help"
                titlePosition="left"
                sqxTourStep="help">
                <i class="icon-help2"></i>
            </a>
        </div>
    </ng-template>
</sqx-layout>

<router-outlet></router-outlet>

<sqx-modal-dialog *sqxModal="eventConsumerErrorDialog" (dialogClose)="eventConsumerErrorDialog.hide()">
    <ng-container title>
        {{ "common.error" | sqxTranslate }}
    </ng-container>

    <ng-container content>
        <textarea class="form-control error-message small" readonly>{{ eventConsumerError }}</textarea>
    </ng-container>
</sqx-modal-dialog>
