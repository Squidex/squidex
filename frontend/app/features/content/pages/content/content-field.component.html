<div class="row no-gutters" [class.compare]="formModelCompare">
    <div [class.col-12]="!formModelCompare" [class.col-6]="formModelCompare">
        <div class="table-items-row" [class.field-invalid]="isInvalid | async" *ngIf="!(formModel.hiddenChanges | async)">
            <div class="languages-buttons">
                <button *ngIf="canTranslate" type="button" class="btn btn-text-secondary btn-sm mr-1" (click)="translate()" title="Autotranslate from master language">
                    <i class="icon-translate"></i>
                </button>

                <sqx-field-languages 
                    [field]="formModel.field"
                    (languageChange)="languageChange.emit($event)"
                    [language]="language"
                    [languages]="languages"
                    [showAllControls]="showAllControls"
                    (showAllControlsChange)="changeShowAllControls($event)">
                </sqx-field-languages>
            </div>
            
            <ng-container *ngIf="showAllControls; else singleControl">
                <div class="form-group" *ngFor="let language of formModel; trackBy: trackByLanguage">
                    <sqx-field-editor
                        [form]="form"
                        [formContext]="formContext"
                        [formModel="formModel.getField(language.iso2Code)"
                        [language]="language"
                        [languages]="languages"
                        [displaySuffix]="prefix(language)">
                    </sqx-field-editor>
                </div>
            </ng-container>
        
            <ng-template #singleControl>
                <sqx-field-editor
                    [form]="form"
                    [formContext]="formContext"
                    [formModel]="getControl()"
                    [language]="language"
                    [languages]="languages">
                </sqx-field-editor>
            </ng-template>
        </div>
    </div>

    <div class="col-6 col-right" *ngIf="formModelCompare">
        <button type="button" class="btn btn-primary btn-sm field-copy" (click)="copy()" *ngIf="isDifferent | async">
            <i class="icon-arrow_back"></i>
        </button>

        <div class="table-items-row" *ngIf="!(formModelCompare!.hiddenChanges | async)">
            <div class="languages-buttons">
                <sqx-field-languages 
                    [field]="formModelCompare!.field"
                    (languageChange)="languageChange.emit($event)"
                    [language]="language"
                    [languages]="languages"
                    [showAllControls]="showAllControls"
                    (showAllControlsChange)="changeShowAllControls($event)">
                </sqx-field-languages>
            </div>

            <ng-container *ngIf="showAllControls; else singleControlCompare">
                <div class="form-group" *ngFor="let language of languages; trackBy: trackByLanguage">
                    <sqx-field-editor
                        [form]="formCompare"
                        [formContext]="formContext"
                        [formModel="formModelCompare.getField(language.iso2Code)"
                        [language]="language"
                        [languages]="languages"
                        [displaySuffix]="prefix(language)">
                    </sqx-field-editor>
                </div>
            </ng-container>
        
            <ng-template #singleControlCompare>
                <sqx-field-editor
                    [formModel]="getControlCompare()"
                    [language]="language"
                    [languages]="languages">
                </sqx-field-editor>
            </ng-template>
        </div>
    </div>
</div>
